# Employees
This is a test assignment

## Installing
Run following commands (in that order recommended)
### Python
With [Python PIP](https://pypi.org/project/pip/) installed run:
```bash
pip install -r requirements.txt
```
#### For MySQL DB
If used with MySQL as opposed to the default SQLite, also requires MySQL client:
```bash
pip install -r optional-requirements.txt
```
Please checl [SQLalchemy documentation](https://docs.sqlalchemy.org/en/latest/dialects/) on requirements for running other SQL dialects.

### Javascript and CSS
With [NPM](https://www.npmjs.com/get-npm) installed:
```bash
npm install
```
This installs the bower package manager to handle the UI necessary components. Then run:
```bash
bower install
```

## Quickstart
### Database
The application uses the **'DATABASE_URL'** environment variable to connect to the database. If unspecified, the application will be using the deafult SQLite database in the 'app.db' file in the root directory of the app. 

#### Schema
This package uses [flask-Migrate](https://flask-migrate.readthedocs.io/en/latest/). To upgrade an empty schema run these commands:
```bash
flask db upgrade
```

#### Seeding
Package includes a seeder which relies on the `seeding/positions.txt` file data that follows following format:
```
top_lvl_position_name, number_of_employees, salary
2_lvl_position_name, number_of_employees, salary
...
```
Posiitons are evaluated top down, with each employee on a level getting as many subordinates as is indicated on the next level down. E.g. in the example provided file (that wil lresult in 65843 employees generated by default), each Country Manager gets 8 Regional Managers in their subordination, each of which gets 8 Branch managers in turn, and so on.
Names of the employees are generated randomly as provided by the Faker package (included in the requirements.txt.).

To seed the DB, please use the `flask shell` command to run interpreter with necessary context already in place and then execute following code:
```Python
seeder = DbSeeder()
seeder.seed()
db.session.commit()
```
This will populate the Database with the entire hierarchy structure as provided in the `seeding/positions.txt` file.
Alternatively, you can set an arbitrary number of levels to be processed from the top, if you would like a smaller hierarchy without having to change the positions file, like so:
```Python
seeder = DbSeeder()
seeder.seed(4)
db.session.commit()
```
This will result in seeding only the top 4 levels of the file.

### Running
You can run the application locally with the following command:
```bash
flask run
```
Which (by default) will start serving the application at http://127.0.0.1:5000/
